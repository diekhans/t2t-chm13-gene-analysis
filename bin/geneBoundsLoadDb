#!/usr/bin/env python3

import argparse
from pycbio.db import sqliteOps
from geneBoundsLib import GeneBoundsBedReader, geneBoundsCreateTable, geneBoundsLoadTable, geneBoundsCreateIndexes

def parseArgs():
    usage = """load GeneBoundsBed into sqlite datbases"""
    parser = argparse.ArgumentParser(description=usage)
    parser.add_argument('geneBoundsBed',
                        help="BED for each gene bounds")
    parser.add_argument('geneBoundsDb',
                        help="sqlite DB")
    opts = parser.parse_args()
    return opts

def main(opts):
    recs = [r for r in GeneBoundsBedReader(opts.geneBoundsBed)]
    conn = sqliteOps.connect(opts.geneBoundsDb, create=True)
    geneBoundsCreateTable(conn)
    geneBoundsLoadTable(conn, recs)
    geneBoundsCreateIndexes(conn)

main(parseArgs())
